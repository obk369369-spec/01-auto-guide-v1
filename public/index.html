<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<title>붙여넣기 처리 도구 v2.1</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
:root{font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;background:#f6f7f9;color:#111}
body{margin:0;padding:12px}
.badges{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px}
.badge{padding:6px 10px;border:1px solid #cfd6e4;border-radius:999px;background:#fff;font-size:12px}
.app{max-width:980px;margin:auto;display:grid;gap:12px}
.card{background:#fff;border:1px solid #cfd6e4;border-radius:12px;padding:10px}
h2{margin:0 0 6px;font-size:14px}
textarea,button{width:100%;padding:8px;border-radius:8px;border:1px solid #cfd6e4;font-size:13px}
textarea{min-height:120px}
.btns{display:flex;gap:6px;flex-wrap:wrap}
.out{white-space:pre-wrap;border:1px dashed #cfd6e4;border-radius:8px;padding:8px;min-height:120px;background:#fafafa}
.pass{background:#e6fffa}
.fail{background:#fff1f2}
</style>
</head>
<body>

<div class="badges">
  <div class="badge">JS: <b id="b_js">OK</b></div>
  <div class="badge">STATE: <b id="b_state">X</b></div>
</div>

<div class="app">
  <div class="card">
    <h2>입력 (붙여넣기)</h2>
    <textarea id="inp" placeholder="여기에 텍스트를 붙여넣기"></textarea>
    <div class="btns" style="margin-top:6px">
      <button id="run">실행</button>
      <button id="save">저장</button>
      <button id="clear">초기화</button>
      <button id="test">자동 테스트 1회</button>
    </div>
  </div>

  <div class="card">
    <h2>결과</h2>
    <div id="out" class="out">—</div>
  </div>
</div>

<script>
const KEY="tool_v21_state";
const $=id=>document.getElementById(id);

function process(t){
  // 규칙 처리: 줄 수, 단어 수, 첫 200자 요약
  const lines=t.split(/\r?\n/).filter(x=>x.trim()!=="");
  const words=t.trim()?t.trim().split(/\s+/).length:0;
  return [
    "[처리 결과]",
    "줄 수: "+lines.length,
    "단어 수: "+words,
    "",
    "요약:",
    t.slice(0,200)
  ].join("\n");
}

function setState(ok){
  $("b_state").textContent= ok?"OK":"X";
  $("b_state").parentElement.className="badge "+(ok?"pass":"fail");
}

$("run").onclick=()=>{
  const t=$("inp").value;
  $("out").textContent=process(t);
  setState(true);
};

$("save").onclick=()=>{
  localStorage.setItem(KEY, JSON.stringify({inp:$("inp").value,out:$("out").textContent}));
  setState(true);
};

$("clear").onclick=()=>{
  $("inp").value="";
  $("out").textContent="—";
  localStorage.removeItem(KEY);
  setState(false);
};

$("test").onclick=()=>{
  const sample="테스트 문장\n두번째 줄";
  const r=process(sample);
  const pass=r.includes("줄 수: 2") && r.includes("단어 수:");
  setState(pass);
};

(function restore(){
  const s=localStorage.getItem(KEY);
  if(!s) return;
  const d=JSON.parse(s);
  $("inp").value=d.inp||"";
  $("out").textContent=d.out||"—";
  setState(true);
})();
</script>
</body>
</html>
