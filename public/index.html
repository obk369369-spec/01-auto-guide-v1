<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>1ë²ˆ ë„êµ¬ Â· ê³ ê° ìë™í™” ì•ˆë‚´ì„œ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #0f172a;
      --bg-inner: #020617;
      --bg-card: #020617;
      --border-soft: #1f2937;
      --border-strong: #374151;
      --text-main: #e5e7eb;
      --text-sub: #9ca3af;
      --accent: #3b82f6;
      --accent-soft: rgba(59, 130, 246, 0.15);
      --danger: #f97373;
      --success: #22c55e;
      --radius-lg: 16px;
      --radius-md: 12px;
      --radius-sm: 9px;
      --shadow-soft: 0 18px 45px rgba(15, 23, 42, 0.65);
      --shadow-card: 0 10px 30px rgba(15, 23, 42, 0.75);
      --font-main: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      background: radial-gradient(circle at top, #1f2937 0, #020617 52%, #000 100%);
      color: var(--text-main);
      font-family: var(--font-main);
    }

    body {
      min-height: 100vh;
      display: flex;
      justify-content: center;
    }

    .app-shell {
      width: 100%;
      max-width: 1180px;
      padding: 18px 12px 28px;
    }

    @media (min-width: 960px) {
      .app-shell {
        padding: 26px 0 36px;
      }
    }

    .app-frame {
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.94), rgba(15, 23, 42, 0.98));
      border-radius: 24px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      box-shadow: var(--shadow-soft);
      padding: 18px 18px 20px;
      backdrop-filter: blur(14px);
    }

    @media (max-width: 720px) {
      .app-frame {
        padding: 14px 12px 16px;
        border-radius: 18px;
      }
    }

    header {
      display: grid;
      grid-template-columns: minmax(0, 2.4fr) minmax(0, 1.6fr);
      gap: 14px;
      margin-bottom: 14px;
    }

    @media (max-width: 880px) {
      header {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .title-block {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .app-title {
      font-size: 20px;
      font-weight: 700;
      letter-spacing: 0.02em;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .app-title span.badge-main {
      font-size: 11px;
      font-weight: 600;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(96, 165, 250, 0.6);
      background: rgba(15, 23, 42, 0.9);
      color: #bfdbfe;
    }

    .app-subtitle {
      font-size: 13px;
      color: var(--text-sub);
      max-width: 580px;
    }

    .tag-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 2px;
    }

    .tag {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: rgba(15, 23, 42, 0.9);
      color: #9ca3af;
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }

    .tag-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 8px rgba(59, 130, 246, 0.7);
    }

    .header-stats {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 8px;
      align-items: stretch;
    }

    @media (max-width: 600px) {
      .header-stats {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .stat-card {
      border-radius: 14px;
      border: 1px solid rgba(31, 41, 55, 0.95);
      background: radial-gradient(circle at top left, rgba(30, 64, 175, 0.18), rgba(15, 23, 42, 0.95));
      padding: 8px 9px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 2px;
      box-shadow: var(--shadow-card);
    }

    .stat-label {
      font-size: 11px;
      color: var(--text-sub);
    }

    .stat-value {
      font-size: 16px;
      font-weight: 700;
    }

    .stat-pill {
      margin-top: 1px;
      align-self: flex-start;
      padding: 2px 7px;
      border-radius: 999px;
      font-size: 10px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(55, 65, 81, 0.9);
      color: #9ca3af;
    }

    .layout-main {
      display: grid;
      grid-template-columns: minmax(0, 1.15fr) minmax(0, 1.1fr);
      gap: 14px;
    }

    @media (max-width: 960px) {
      .layout-main {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .column {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .card {
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.96), rgba(15, 23, 42, 0.98));
      border-radius: var(--radius-lg);
      border: 1px solid rgba(55, 65, 81, 0.95);
      box-shadow: var(--shadow-card);
      padding: 12px 12px 13px;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 8px;
    }

    .card-title {
      font-size: 14px;
      font-weight: 600;
    }

    .card-subtitle {
      font-size: 11px;
      color: var(--text-sub);
    }

    .badge {
      font-size: 10px;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(75, 85, 99, 0.9);
      background: rgba(15, 23, 42, 0.9);
      color: var(--text-sub);
      white-space: nowrap;
    }

    .badge-accent {
      border-color: rgba(59, 130, 246, 0.7);
      color: #bfdbfe;
    }

    .card-body {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .field {
      flex: 1 1 140px;
      min-width: 0;
      display: flex;
      flex-direction: column;
      gap: 3px;
    }

    .field-half {
      flex: 1 1 48%;
    }

    .field-label-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .field-label {
      font-size: 11px;
      font-weight: 500;
      color: #e5e7eb;
    }

    .field-hint {
      font-size: 10px;
      color: #6b7280;
    }

    input[type="text"],
    input[type="email"],
    input[type="number"],
    textarea,
    select {
      width: 100%;
      border-radius: var(--radius-sm);
      border: 1px solid rgba(55, 65, 81, 0.95);
      padding: 6px 8px;
      font-size: 12px;
      font-family: var(--font-main);
      background: radial-gradient(circle at top, #020617, #020617);
      color: var(--text-main);
      outline: none;
      transition: border-color 0.14s ease, box-shadow 0.14s ease, background 0.14s ease;
    }

    textarea {
      min-height: 70px;
      max-height: 180px;
      resize: vertical;
      line-height: 1.45;
    }

    input::placeholder,
    textarea::placeholder {
      color: #4b5563;
    }

    input:focus,
    textarea:focus,
    select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.6);
      background: radial-gradient(circle at top, #020617, #020617);
    }

    .btn-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 2px;
    }

    button {
      border-radius: 999px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.96), rgba(15, 23, 42, 0.98));
      padding: 6px 11px;
      font-size: 11px;
      font-weight: 600;
      color: var(--text-main);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
      transition: background 0.14s ease, box-shadow 0.14s ease, transform 0.04s ease;
    }

    button .icon {
      font-size: 13px;
      line-height: 0;
    }

    button:hover {
      box-shadow: 0 12px 32px rgba(15, 23, 42, 0.9);
      transform: translateY(-1px);
      border-color: rgba(59, 130, 246, 0.7);
    }

    button:active {
      transform: translateY(0);
      box-shadow: 0 6px 16px rgba(15, 23, 42, 0.85);
    }

    button:disabled {
      opacity: 0.5;
      cursor: default;
      box-shadow: none;
      transform: none;
    }

    .btn-primary {
      border-color: rgba(59, 130, 246, 0.9);
      background: radial-gradient(circle at top left, #2563eb, #1d4ed8);
      color: #e5f0ff;
    }

    .btn-soft {
      border-style: dashed;
      border-color: rgba(75, 85, 99, 0.9);
    }

    .btn-danger {
      border-color: rgba(239, 68, 68, 0.9);
      background: radial-gradient(circle at top left, #b91c1c, #7f1d1d);
      color: #fee2e2;
    }

    .status-strip {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      font-size: 10px;
      color: var(--text-sub);
      margin-top: 2px;
    }

    .status-pill {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 10px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: rgba(15, 23, 42, 0.9);
    }

    .status-pill.ok {
      border-color: rgba(34, 197, 94, 0.9);
      color: #bbf7d0;
    }

    .status-pill.warn {
      border-color: rgba(245, 158, 11, 0.9);
      color: #fed7aa;
    }

    .status-pill.error {
      border-color: rgba(248, 113, 113, 0.95);
      color: #fecaca;
    }

    .status-pill.neutral {
      color: var(--text-sub);
    }

    .status-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 7px rgba(34, 197, 94, 0.7);
    }

    .status-dot.warn {
      background: #f59e0b;
      box-shadow: 0 0 7px rgba(245, 158, 11, 0.7);
    }

    .status-dot.error {
      background: #ef4444;
      box-shadow: 0 0 7px rgba(239, 68, 68, 0.7);
    }

    .small-text {
      font-size: 10px;
      color: var(--text-sub);
    }

    .preview-header-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }

    .preview-toggle-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 4px;
      align-items: center;
    }

    .pill-toggle {
      font-size: 10px;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: rgba(15, 23, 42, 0.9);
      color: var(--text-sub);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }

    .pill-toggle.active {
      border-color: rgba(59, 130, 246, 0.9);
      color: #bfdbfe;
      box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.8);
    }

    .preview-box {
      border-radius: var(--radius-md);
      border: 1px solid rgba(55, 65, 81, 0.95);
      background: radial-gradient(circle at top, #020617, #020617);
      padding: 9px 9px 10px;
      font-size: 12px;
      line-height: 1.55;
      max-height: 260px;
      overflow-y: auto;
      white-space: pre-wrap;
      word-break: keep-all;
    }

    .preview-empty {
      color: #6b7280;
      font-size: 12px;
    }

    .guide-section-title {
      font-weight: 600;
      color: #e5e7eb;
      margin-top: 6px;
      margin-bottom: 2px;
    }

    .guide-section-title:first-child {
      margin-top: 0;
    }

    .guide-section-body {
      margin-bottom: 4px;
    }

    .textarea-plain {
      display: none;
      border-radius: var(--radius-md);
      border: 1px solid rgba(55, 65, 81, 0.95);
      background: radial-gradient(circle at top, #020617, #020617);
      padding: 8px 9px;
      font-size: 12px;
      line-height: 1.5;
      max-height: 260px;
      overflow-y: auto;
    }

    .textarea-plain.active {
      display: block;
    }

    .plain-hidden {
      display: none;
    }

    .grid-followup {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1fr);
      gap: 8px;
    }

    @media (max-width: 720px) {
      .grid-followup {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .check-row {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      color: var(--text-main);
      padding: 4px 6px;
      border-radius: 8px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: rgba(15, 23, 42, 0.9);
    }

    .check-row input[type="checkbox"] {
      width: 14px;
      height: 14px;
      margin: 0;
      accent-color: #3b82f6;
    }

    .check-row label {
      flex: 1 1 auto;
    }

    .check-row input[type="date"] {
      flex: 0 0 auto;
      max-width: 120px;
      font-size: 10px;
      padding: 4px 6px;
    }

    .followup-summary {
      border-radius: var(--radius-md);
      border: 1px dashed rgba(75, 85, 99, 0.9);
      background: rgba(15, 23, 42, 0.9);
      padding: 7px 8px;
      font-size: 11px;
      min-height: 40px;
      color: var(--text-sub);
    }

    .followup-summary strong {
      color: #e5e7eb;
    }

    .error-text {
      font-size: 10px;
      color: #fecaca;
      margin-top: 2px;
      display: none;
    }

    .error-text.visible {
      display: block;
    }

    footer {
      margin-top: 8px;
      display: flex;
      justify-content: flex-end;
      font-size: 10px;
      color: var(--text-sub);
    }

    footer span {
      color: #9ca3af;
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <div class="app-frame">
      <header>
        <div class="title-block">
          <div class="app-title">
            1ë²ˆ ë„êµ¬ Â· ê³ ê° ìë™í™” ì•ˆë‚´ì„œ
            <span class="badge-main">ê³ ê°ë³„ ì›Œë“œ/ë©”ì¼ìš© ì•ˆë‚´ì„œ Â· ë¡œì»¬ ìë™í™”</span>
          </div>
          <div class="app-subtitle">
            ì—°êµ¬ìÂ·ê³ ê° ì •ë³´ë¥¼ ì…ë ¥í•˜ë©´, ì¸ì‚¬Â·ì†Œê°œÂ·ë§ì¶¤ ì œì•ˆÂ·í›„ì† ì•ˆë‚´ê¹Œì§€ í•œ ë²ˆì— ë¬¶ì¸
            ìë™ ì•ˆë‚´ì„œ ì´ˆì•ˆì„ ë§Œë“¤ì–´ ì£¼ê³ , í›„ì† ì¡°ì¹˜ ì²´í¬ë¦¬ìŠ¤íŠ¸ë„ ê°™ì´ ê´€ë¦¬í•©ë‹ˆë‹¤.
          </div>
          <div class="tag-row">
            <div class="tag">
              <span class="tag-dot"></span>
              Local-only Â· Safe DOM Â· v1.0
            </div>
            <div class="tag">
              <span class="tag-dot"></span>
              ì €ì¥: ì´ ë¸Œë¼ìš°ì €ì˜ localStorageë§Œ ì‚¬ìš©
            </div>
            <div class="tag">
              <span class="tag-dot"></span>
              í™”ë©´ì— ë³´ì´ëŠ” ê¸°ëŠ¥ë§Œ ë™ì‘ (ì„œë²„/íƒ€ì´ë¨¸ ì—†ìŒ)
            </div>
          </div>
        </div>
        <div class="header-stats">
          <div class="stat-card">
            <div class="stat-label">ëˆ„ì  ì•ˆë‚´ì„œ ìƒì„±</div>
            <div class="stat-value" id="statTotalGuides">0</div>
            <div class="stat-pill">Generate count</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">ì˜¤ëŠ˜ ë§Œë“  ì•ˆë‚´ì„œ</div>
            <div class="stat-value" id="statTodayGuides">0</div>
            <div class="stat-pill">Today</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">ë§ˆì§€ë§‰ ìƒì„± ì‹œê°</div>
            <div class="stat-value" style="font-size:13px" id="statLastTime">-</div>
          </div>
        </div>
      </header>

      <main class="layout-main">
        <!-- ì™¼ìª½: ê³ ê° ì •ë³´ + ì˜µì…˜ -->
        <section class="column">
          <article class="card" aria-label="ê³ ê° ê¸°ë³¸ ì •ë³´">
            <div class="card-header">
              <div>
                <div class="card-title">A. ê³ ê° ê¸°ë³¸ ì •ë³´</div>
                <div class="card-subtitle">
                  ì—‘ì…€ ê³ ê°DBì—ì„œ ì˜®ê²¨ ì ëŠ” ê²ƒì„ ê¸°ì¤€ìœ¼ë¡œ, ì•ˆë‚´ì„œì— í•„ìˆ˜ë¡œ ë“¤ì–´ê°€ëŠ” ê¸°ë³¸ í•„ë“œì…ë‹ˆë‹¤.
                </div>
              </div>
              <div class="badge">í•„ìˆ˜: ì´ë¦„ ë˜ëŠ” ê¸°ê´€ ì¤‘ 1ê°œ ì´ìƒ</div>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="field field-half">
                  <div class="field-label-row">
                    <div class="field-label">ê³ ê° ì´ë¦„</div>
                    <div class="field-hint">ì˜ˆ: í™ê¸¸ë™</div>
                  </div>
                  <input id="inputName" type="text" placeholder="ê³ ê° ì´ë¦„" autocomplete="off" />
                </div>
                <div class="field field-half">
                  <div class="field-label-row">
                    <div class="field-label">ì§í•¨ / ì§ìœ„</div>
                    <div class="field-hint">ì˜ˆ: ë°•ì‚¬ / ì±…ì„ì—°êµ¬ì›</div>
                  </div>
                  <input id="inputTitle" type="text" placeholder="ì§í•¨ / ì§ìœ„" autocomplete="off" />
                </div>
              </div>

              <div class="row">
                <div class="field field-half">
                  <div class="field-label-row">
                    <div class="field-label">ê¸°ê´€ / íšŒì‚¬</div>
                    <div class="field-hint">ì˜ˆ: KIST / KITECH</div>
                  </div>
                  <input id="inputOrg" type="text" placeholder="ê¸°ê´€ / íšŒì‚¬ ì´ë¦„" autocomplete="off" />
                </div>
                <div class="field field-half">
                  <div class="field-label-row">
                    <div class="field-label">ë¶€ì„œ / ì—°êµ¬ì‹¤</div>
                    <div class="field-hint">ì˜ˆ: ì†Œì¬ë¶€í’ˆì—°êµ¬ë¶€</div>
                  </div>
                  <input id="inputDept" type="text" placeholder="ë¶€ì„œ / ì—°êµ¬ì‹¤" autocomplete="off" />
                </div>
              </div>

              <div class="row">
                <div class="field field-half">
                  <div class="field-label-row">
                    <div class="field-label">ì—°êµ¬ / ê´€ì‹¬ ë¶„ì•¼</div>
                    <div class="field-hint">ì˜ˆ: ë°˜ë„ì²´ íŒ¨í‚¤ì§• ì ‘ì°©ì œ</div>
                  </div>
                  <input id="inputField" type="text" placeholder="ì—°êµ¬ / ê´€ì‹¬ í‚¤ì›Œë“œ í•œ ì¤„" autocomplete="off" />
                </div>
                <div class="field field-half">
                  <div class="field-label-row">
                    <div class="field-label">ì˜ˆìƒ ì˜ˆì‚° / ì—°êµ¬ë¹„</div>
                    <div class="field-hint">ì˜ˆ: ì—° 1,200ë§Œì›</div>
                  </div>
                  <input id="inputBudget" type="text" placeholder="ì˜ˆ: 1,200ë§Œì› ìˆ˜ì¤€" autocomplete="off" />
                </div>
              </div>

              <div class="row">
                <div class="field field-half">
                  <div class="field-label-row">
                    <div class="field-label">ì´ë©”ì¼</div>
                    <div class="field-hint">ì„ íƒ</div>
                  </div>
                  <input id="inputEmail" type="email" placeholder="example@org.re.kr" autocomplete="off" />
                </div>
                <div class="field field-half">
                  <div class="field-label-row">
                    <div class="field-label">ë‚´ ë©”ëª¨ (ì§§ê²Œ)</div>
                    <div class="field-hint">ì˜ˆ: ê¸°ì¡´ ê³ ê° / ì˜ˆì‚° ìˆìŒ</div>
                  </div>
                  <input id="inputShortNote" type="text" placeholder="ì•ˆë‚´ì„œì— ê°„ë‹¨íˆ ë°˜ì˜í•  ë©”ëª¨" autocomplete="off" />
                </div>
              </div>

              <div class="status-strip">
                <span class="status-pill neutral" id="basicStatus">
                  <span class="status-dot"></span>
                  ê¸°ë³¸ ì •ë³´ ìƒíƒœ: ëŒ€ê¸° ì¤‘
                </span>
                <span class="small-text">
                  ì´ë¦„Â·ê¸°ê´€Â·ì—°êµ¬ë¶„ì•¼ëŠ” ì•ˆë‚´ì„œ ì¸ì‚¬ë§, ë³¸ë¬¸ ìš”ì•½ì— ìë™ ë°˜ì˜ë©ë‹ˆë‹¤.
                </span>
              </div>
              <div id="basicError" class="error-text">ê³ ê° ì´ë¦„ ë˜ëŠ” ê¸°ê´€ ì¤‘ í•˜ë‚˜ëŠ” ë°˜ë“œì‹œ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.</div>
            </div>
          </article>

          <article class="card" aria-label="ì•ˆë‚´ì„œ ì˜µì…˜">
            <div class="card-header">
              <div>
                <div class="card-title">B. ì•ˆë‚´ì„œ ì˜µì…˜ Â· ë³´ê³ ì„œ ëª©ë¡</div>
                <div class="card-subtitle">
                  ì‹ ê·œ ë¬¸ì˜ / ê¸°ì¡´ ê³ ê° / ì¬ë¬¸ì˜ ìƒí™©ì— ë”°ë¼, í…œí”Œë¦¿ êµ¬ì¡°ì™€ í†¤ì´ ë‹¬ë¼ì§‘ë‹ˆë‹¤.
                </div>
              </div>
              <div class="badge badge-accent">ì•ˆë‚´ì„œ êµ¬ì¡° ìë™ ì¡°í•©</div>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="field field-half">
                  <div class="field-label-row">
                    <div class="field-label">ì•ˆë‚´ì„œ ìœ í˜•</div>
                    <div class="field-hint">ìƒí™© ì„ íƒ</div>
                  </div>
                  <select id="selectGuideType">
                    <option value="new">ì‹ ê·œ ë¬¸ì˜ / ì²« ì•ˆë‚´</option>
                    <option value="follow">í›„ì† ì•ˆë‚´ / ì¬ë¬¸ì˜</option>
                    <option value="renew">ì •ê¸° ì•ˆë‚´ / ì—…ë°ì´íŠ¸</option>
                  </select>
                </div>
                <div class="field field-half">
                  <div class="field-label-row">
                    <div class="field-label">ë¬¸ì²´ / í†¤</div>
                    <div class="field-hint">ì˜ˆ: ì—°êµ¬ì ëŒ€ìƒ ì¡´ëŒ“ë§</div>
                  </div>
                  <select id="selectTone">
                    <option value="standard">ì—°êµ¬ììš© ì •ì¤‘í•œ í†¤</option>
                    <option value="soft">ì¡°ê¸ˆ ë¶€ë“œëŸ¬ìš´ í†¤</option>
                    <option value="brief">ê°„ë‹¨ ìš”ì•½ìš© í†¤</option>
                  </select>
                </div>
              </div>

              <div class="row">
                <div class="field field-half">
                  <div class="field-label-row">
                    <div class="field-label">í•µì‹¬ í‚¤ì›Œë“œ (ì½¤ë§ˆ êµ¬ë¶„)</div>
                    <div class="field-hint">ì˜ˆ: ê¸€ë¼ìŠ¤ ì„œë¸ŒìŠ¤íŠ¸ë ˆì´íŠ¸, ì ‘ì°©ì œ</div>
                  </div>
                  <input id="inputKeywords" type="text" placeholder="í‚¤ì›Œë“œ1, í‚¤ì›Œë“œ2, ..." autocomplete="off" />
                </div>
                <div class="field field-half">
                  <div class="field-label-row">
                    <div class="field-label">ì˜ˆìƒ ì‚¬ìš© ì±„ë„</div>
                    <div class="field-hint">ë©”ì¼ / ì›Œë“œ / PDF</div>
                  </div>
                  <select id="selectChannel">
                    <option value="email">ì´ë©”ì¼ ë³¸ë¬¸ìš©</option>
                    <option value="word">ì›Œë“œ ì•ˆë‚´ì„œ ë¬¸ì„œìš©</option>
                    <option value="both">ë©”ì¼ + ì›Œë“œ ë‘˜ ë‹¤</option>
                  </select>
                </div>
              </div>

              <div class="field">
                <div class="field-label-row">
                  <div class="field-label">ë³´ê³ ì„œ / ìë£Œ ëª©ë¡</div>
                  <div class="field-hint">í•œ ì¤„ë‹¹ 1ê°œ Â· ì œëª©ë§Œ ì ìœ¼ë©´ ë²ˆí˜¸ ë§¤ê¹€</div>
                </div>
                <textarea id="inputReports" placeholder="ì˜ˆì‹œ)
Glass Substrate for Advanced Packaging 2025
Semiconductor Packaging Adhesives: Global Market 2024
ê³ ê¸°ëŠ¥ ì ‘ì°©ì œÂ·ì‹¤ë€íŠ¸ ì„¸ê³„ì‹œì¥ 2023"></textarea>
              </div>

              <div class="field">
                <div class="field-label-row">
                  <div class="field-label">ê³ ê° ìƒì„¸ ë©”ëª¨ (ì•ˆë‚´ì„œ ë³¸ë¬¸ ë°˜ì˜)</div>
                  <div class="field-hint">ì „í™” ë‚´ìš©, ì˜ˆì‚°, ì›í•˜ëŠ” í¬ì¸íŠ¸ ë“± ììœ  ì…ë ¥</div>
                </div>
                <textarea id="inputLongMemo" placeholder="ì˜ˆ)
- ìµœê·¼ íŒ¨í‚¤ì§•ìš© ìœ ë¦¬ê¸°íŒ ê´€ë ¨ ì¤‘ì¥ê¸° ë¡œë“œë§µ ìˆ˜ë¦½ ì¤‘
- êµ­ë‚´Â·í•´ì™¸ ì—…ì²´ ë™í–¥, ê³µì •ë³„ ê¸°ìˆ  í¬ì¸íŠ¸, ë¹„ìš©Â·íˆ¬ì ê·œëª¨ ë°ì´í„° í•„ìš”
- ê¸°í•œ: ë‹¤ìŒ ë‹¬ ì˜ˆì‚° ì§‘í–‰ ì „ê¹Œì§€"></textarea>
              </div>

              <div class="btn-row">
                <button type="button" class="btn-primary" id="btnGenerateGuide">
                  <span class="icon">âš™ï¸</span>
                  ìë™ ì•ˆë‚´ì„œ ì´ˆì•ˆ ìƒì„±
                </button>
                <button type="button" class="btn-soft" id="btnAppendMemo">
                  <span class="icon">â•</span>
                  ë©”ëª¨ë¥¼ ì•ˆë‚´ì„œì— ë§ë¶™ì´ê¸°
                </button>
                <button type="button" class="btn-soft" id="btnResetInputs">
                  <span class="icon">ğŸ§¹</span>
                  ì…ë ¥ ë‚´ìš© ì´ˆê¸°í™”
                </button>
              </div>

              <div class="status-strip">
                <span class="status-pill neutral" id="optionStatus">
                  <span class="status-dot"></span>
                  ì˜µì…˜ ìƒíƒœ: ê¸°ë³¸ê°’ ì‚¬ìš© ì¤‘
                </span>
                <span class="small-text">
                  ì•ˆë‚´ì„œ ìƒì„± í›„ì—ë„ ì˜µì…˜ì„ ë°”ê¿” ë‹¤ì‹œ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </span>
              </div>
            </div>
          </article>
        </section>

        <!-- ì˜¤ë¥¸ìª½: ë¯¸ë¦¬ë³´ê¸° + í›„ì†ì¡°ì¹˜ -->
        <section class="column">
          <article class="card" aria-label="ìë™ ì•ˆë‚´ì„œ ë¯¸ë¦¬ë³´ê¸°">
            <div class="card-header">
              <div class="preview-header-row">
                <div>
                  <div class="card-title">C. ìë™ ì•ˆë‚´ì„œ ë¯¸ë¦¬ë³´ê¸°</div>
                  <div class="card-subtitle">
                    ì¸ì‚¬Â·ì†Œê°œÂ·ë§ì¶¤ ì œì•ˆÂ·í›„ì† ì•ˆë‚´ê¹Œì§€ í•œ ë²ˆì— ë¶™ì—¬ ë„£ì„ ìˆ˜ ìˆëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤.
                  </div>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="preview-toggle-row">
                <div class="pill-toggle active" id="toggleViewFormatted">
                  <span class="icon">ğŸ“„</span>
                  ì•ˆë‚´ì„œ í˜•ì‹ ë³´ê¸°
                </div>
                <div class="pill-toggle" id="toggleViewPlain">
                  <span class="icon">ğŸ“‹</span>
                  ìˆœìˆ˜ í…ìŠ¤íŠ¸ ë³´ê¸° (ë³µì‚¬ìš©)
                </div>
                <div class="btn-row" style="margin-left:auto; margin-top:0;">
                  <button type="button" class="btn-soft" id="btnCopyGuide">
                    <span class="icon">ğŸ“</span>
                    í´ë¦½ë³´ë“œ ë³µì‚¬
                  </button>
                  <button type="button" class="btn-soft" id="btnInsertWordMarkers">
                    <span class="icon">ğŸ“</span>
                    ì›Œë“œ êµ¬ë¶„ì„  ì¶”ê°€
                  </button>
                </div>
              </div>

              <div id="guidePreviewBox" class="preview-box">
                <div class="preview-empty">
                  ì•„ì§ ìë™ ì•ˆë‚´ì„œê°€ ì—†ìŠµë‹ˆë‹¤. ì™¼ìª½ì—ì„œ ê³ ê° ì •ë³´ì™€ ì˜µì…˜ì„ ì…ë ¥í•œ ë’¤
                  <strong>ã€Œìë™ ì•ˆë‚´ì„œ ì´ˆì•ˆ ìƒì„±ã€</strong> ë²„íŠ¼ì„ ëˆŒëŸ¬ ì£¼ì„¸ìš”.
                </div>
              </div>

              <textarea id="guidePlainText" class="textarea-plain" readonly></textarea>

              <div class="status-strip">
                <span class="status-pill neutral" id="guideStatus">
                  <span class="status-dot"></span>
                  ì•ˆë‚´ì„œ ìƒíƒœ: ì•„ì§ ìƒì„± ì „
                </span>
                <span class="small-text" id="guideMetaText">
                  ì´ ì•ˆë‚´ì„œëŠ” ì´ ë¸Œë¼ìš°ì €ì—ë§Œ ì €ì¥ë˜ë©°, ìƒˆë¡œê³ ì¹¨ í›„ì—ë„ ë³µì›ë©ë‹ˆë‹¤.
                </span>
              </div>
            </div>
          </article>

          <article class="card" aria-label="í›„ì† ì¡°ì¹˜ ì²´í¬ë¦¬ìŠ¤íŠ¸">
            <div class="card-header">
              <div>
                <div class="card-title">D. í›„ì† ì¡°ì¹˜ Â· Follow-up ì²´í¬ë¦¬ìŠ¤íŠ¸</div>
                <div class="card-subtitle">
                  ì•ˆë‚´ì„œì™€ ì—°ê²°ëœ ì „í™” / ë©”ì¼ / ê²¬ì  / ì…ì°° ë“± í›„ì† í–‰ë™ì„ í•œ í™”ë©´ì—ì„œ ê´€ë¦¬í•©ë‹ˆë‹¤.
                </div>
              </div>
              <div class="badge">ê³ ê° ë‹¨ìœ„ ë¡œì»¬ ì²´í¬ë¦¬ìŠ¤íŠ¸</div>
            </div>
            <div class="card-body">
              <div class="grid-followup">
                <div class="column" style="gap:6px;">
                  <div class="check-row">
                    <input id="chkCall" type="checkbox" />
                    <label for="chkCall">ì „í™” ìƒë‹´ ì˜ˆì •</label>
                    <input id="dateCall" type="date" />
                  </div>
                  <div class="check-row">
                    <input id="chkEmail" type="checkbox" />
                    <label for="chkEmail">ì•ˆë‚´ ë©”ì¼ ë°œì†¡ / íšŒì‹  ëŒ€ê¸°</label>
                    <input id="dateEmail" type="date" />
                  </div>
                  <div class="check-row">
                    <input id="chkQuote" type="checkbox" />
                    <label for="chkQuote">ê³µì‹ ê²¬ì ì„œ / ì¸ë³´ì´ìŠ¤ ë°œì†¡</label>
                    <input id="dateQuote" type="date" />
                  </div>
                  <div class="check-row">
                    <input id="chkBidding" type="checkbox" />
                    <label for="chkBidding">ì…ì°° / ì¡°ë‹¬ ë“±ë¡ ì¤€ë¹„</label>
                    <input id="dateBidding" type="date" />
                  </div>
                </div>
                <div class="column" style="gap:6px;">
                  <div class="field">
                    <div class="field-label-row">
                      <div class="field-label">ì¶”ê°€ ë©”ëª¨ (í›„ì† ì¡°ì¹˜ìš©)</div>
                      <div class="field-hint">ì˜ˆ: ì…ì°° ë§ˆê°ì¼ / ë‚´ë¶€ ê²°ì¬ ì¼ì •</div>
                    </div>
                    <textarea id="inputFollowupMemo" placeholder="ì˜ˆ)
- KISTI ì¡°ë‹¬ ë“±ë¡ í•„ìš” ì—¬ë¶€ í™•ì¸
- ë‚´ë¶€ ê²°ì¬ë¼ì¸: íŒ€ì¥ â†’ ë³¸ë¶€ì¥
- ì˜ˆì‚° ì§‘í–‰ ê¸°í•œ: 1ì›” ë§ê¹Œì§€"></textarea>
                  </div>
                  <div class="followup-summary" id="followupSummary">
                    <strong>ë‹¤ìŒ í•  ì¼ ìš”ì•½:</strong> ì²´í¬ë¦¬ìŠ¤íŠ¸ë¥¼ ì„ íƒí•˜ë©´ ì—¬ê¸° í•œ ì¤„ë¡œ ì •ë¦¬ë©ë‹ˆë‹¤.
                  </div>
                </div>
              </div>

              <div class="btn-row">
                <button type="button" class="btn-primary" id="btnSaveFollowup">
                  <span class="icon">ğŸ’¾</span>
                  í›„ì† ì¡°ì¹˜ ìƒíƒœ ì €ì¥
                </button>
                <button type="button" class="btn-soft" id="btnRefreshFollowup">
                  <span class="icon">ğŸ”„</span>
                  ìš”ì•½ ë‹¤ì‹œ ê³„ì‚°
                </button>
                <button type="button" class="btn-danger" id="btnClearFollowup">
                  <span class="icon">â™»ï¸</span>
                  ì²´í¬ë¦¬ìŠ¤íŠ¸ ì´ˆê¸°í™”
                </button>
              </div>

              <div class="status-strip">
                <span class="status-pill neutral" id="followupStatus">
                  <span class="status-dot"></span>
                  í›„ì† ì¡°ì¹˜ ìƒíƒœ: ë¯¸ì €ì¥
                </span>
                <span class="small-text">
                  ì²´í¬ë¦¬ìŠ¤íŠ¸ì™€ ë©”ëª¨ëŠ” ì´ ë¸Œë¼ìš°ì €ì˜ localStorageì—ë§Œ ì €ì¥ë©ë‹ˆë‹¤.
                </span>
              </div>
            </div>
          </article>
        </section>
      </main>

      <footer>
        <div>
          <span>Local-only / Static Â· </span>public/index.html Â· ê³ ê° ìë™í™” ì•ˆë‚´ì„œ v1.0
        </div>
      </footer>
    </div>
  </div>

  <script>
    (function () {
      "use strict";

      const STORAGE_KEY_STATE = "wic_customer_guide_state_v1";
      const STORAGE_KEY_STATS = "wic_customer_guide_stats_v1";
      const STORAGE_KEY_FOLLOWUP = "wic_customer_guide_followup_v1";

      const $ = (id) => document.getElementById(id);

      const inputName = $("inputName");
      const inputTitle = $("inputTitle");
      const inputOrg = $("inputOrg");
      const inputDept = $("inputDept");
      const inputField = $("inputField");
      const inputBudget = $("inputBudget");
      const inputEmail = $("inputEmail");
      const inputShortNote = $("inputShortNote");

      const selectGuideType = $("selectGuideType");
      const selectTone = $("selectTone");
      const selectChannel = $("selectChannel");
      const inputKeywords = $("inputKeywords");
      const inputReports = $("inputReports");
      const inputLongMemo = $("inputLongMemo");

      const btnGenerateGuide = $("btnGenerateGuide");
      const btnAppendMemo = $("btnAppendMemo");
      const btnResetInputs = $("btnResetInputs");

      const basicStatus = $("basicStatus");
      const basicError = $("basicError");
      const optionStatus = $("optionStatus");

      const guidePreviewBox = $("guidePreviewBox");
      const guidePlainText = $("guidePlainText");
      const guideStatus = $("guideStatus");
      const guideMetaText = $("guideMetaText");
      const btnCopyGuide = $("btnCopyGuide");
      const btnInsertWordMarkers = $("btnInsertWordMarkers");

      const toggleViewFormatted = $("toggleViewFormatted");
      const toggleViewPlain = $("toggleViewPlain");

      const statTotalGuides = $("statTotalGuides");
      const statTodayGuides = $("statTodayGuides");
      const statLastTime = $("statLastTime");

      const chkCall = $("chkCall");
      const chkEmail = $("chkEmail");
      const chkQuote = $("chkQuote");
      const chkBidding = $("chkBidding");
      const dateCall = $("dateCall");
      const dateEmail = $("dateEmail");
      const dateQuote = $("dateQuote");
      const dateBidding = $("dateBidding");
      const inputFollowupMemo = $("inputFollowupMemo");
      const followupSummary = $("followupSummary");
      const followupStatus = $("followupStatus");

      const btnSaveFollowup = $("btnSaveFollowup");
      const btnRefreshFollowup = $("btnRefreshFollowup");
      const btnClearFollowup = $("btnClearFollowup");

      function isValidNonEmpty(str) {
        return typeof str === "string" && str.trim().length > 0;
      }

      function setStatusPill(pillEl, type, text) {
        if (!pillEl) return;
        pillEl.textContent = "";
        const dot = document.createElement("span");
        dot.className = "status-dot";
        if (type === "warn") dot.classList.add("warn");
        if (type === "error") dot.classList.add("error");
        const spanText = document.createElement("span");
        spanText.textContent = text;

        pillEl.className = "status-pill";
        if (type === "ok") {
          pillEl.classList.add("ok");
        } else if (type === "warn") {
          pillEl.classList.add("warn");
        } else if (type === "error") {
          pillEl.classList.add("error");
        } else {
          pillEl.classList.add("neutral");
        }
        pillEl.appendChild(dot);
        pillEl.appendChild(spanText);
      }

      function formatDateTime(dt) {
        const d = dt instanceof Date ? dt : new Date(dt);
        if (Number.isNaN(d.getTime())) return "-";
        const pad = (n) => String(n).padStart(2, "0");
        return (
          d.getFullYear() +
          "-" +
          pad(d.getMonth() + 1) +
          "-" +
          pad(d.getDate()) +
          " " +
          pad(d.getHours()) +
          ":" +
          pad(d.getMinutes())
        );
      }

      function parseJSONSafe(value, fallback) {
        try {
          if (!value) return fallback;
          const parsed = JSON.parse(value);
          return typeof parsed === "object" && parsed !== null ? parsed : fallback;
        } catch (e) {
          return fallback;
        }
      }

      function saveState() {
        const state = {
          customer: {
            name: inputName.value || "",
            title: inputTitle.value || "",
            org: inputOrg.value || "",
            dept: inputDept.value || "",
            field: inputField.value || "",
            budget: inputBudget.value || "",
            email: inputEmail.value || "",
            shortNote: inputShortNote.value || ""
          },
          options: {
            guideType: selectGuideType.value,
            tone: selectTone.value,
            channel: selectChannel.value,
            keywords: inputKeywords.value || ""
          },
          reportsText: inputReports.value || "",
          memoText: inputLongMemo.value || "",
          guideText: guidePlainText.value || ""
        };
        try {
          localStorage.setItem(STORAGE_KEY_STATE, JSON.stringify(state));
        } catch (e) {
          // ignore
        }
      }

      function loadState() {
        try {
          const raw = localStorage.getItem(STORAGE_KEY_STATE);
          if (!raw) return;
          const state = parseJSONSafe(raw, null);
          if (!state) return;

          if (state.customer) {
            inputName.value = state.customer.name || "";
            inputTitle.value = state.customer.title || "";
            inputOrg.value = state.customer.org || "";
            inputDept.value = state.customer.dept || "";
            inputField.value = state.customer.field || "";
            inputBudget.value = state.customer.budget || "";
            inputEmail.value = state.customer.email || "";
            inputShortNote.value = state.customer.shortNote || "";
          }
          if (state.options) {
            if (state.options.guideType) selectGuideType.value = state.options.guideType;
            if (state.options.tone) selectTone.value = state.options.tone;
            if (state.options.channel) selectChannel.value = state.options.channel;
            inputKeywords.value = state.options.keywords || "";
          }
          inputReports.value = state.reportsText || "";
          inputLongMemo.value = state.memoText || "";

          if (isValidNonEmpty(state.guideText)) {
            guidePlainText.value = state.guideText;
            renderGuideFromPlain(state.guideText);
            setStatusPill(guideStatus, "ok", "ì•ˆë‚´ì„œ ìƒíƒœ: ì €ì¥ëœ ì•ˆë‚´ì„œë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.");
          }
        } catch (e) {
          // ignore
        }
      }

      function saveStats(newStats) {
        try {
          localStorage.setItem(STORAGE_KEY_STATS, JSON.stringify(newStats));
        } catch (e) {
          // ignore
        }
      }

      function loadStats() {
        try {
          const raw = localStorage.getItem(STORAGE_KEY_STATS);
          if (!raw) return null;
          return parseJSONSafe(raw, null);
        } catch (e) {
          return null;
        }
      }

      function updateStatsOnGenerate() {
        const now = new Date();
        const todayKey = now.toISOString().slice(0, 10);
        let stats = loadStats();
        if (!stats) {
          stats = {
            totalGuides: 0,
            todayGuides: 0,
            todayKey: todayKey,
            lastGeneratedAt: null
          };
        }
        stats.totalGuides += 1;
        if (stats.todayKey !== todayKey) {
          stats.todayGuides = 0;
          stats.todayKey = todayKey;
        }
        stats.todayGuides += 1;
        stats.lastGeneratedAt = now.toISOString();
        saveStats(stats);
        applyStatsToUI(stats);
      }

      function applyStatsToUI(stats) {
        if (!stats) return;
        statTotalGuides.textContent = String(stats.totalGuides || 0);
        statTodayGuides.textContent = String(stats.todayGuides || 0);
        if (stats.lastGeneratedAt) {
          statLastTime.textContent = formatDateTime(stats.lastGeneratedAt);
        } else {
          statLastTime.textContent = "-";
        }
      }

      function loadAndApplyStats() {
        const stats = loadStats();
        if (!stats) return;
        applyStatsToUI(stats);
      }

      function loadFollowup() {
        try {
          const raw = localStorage.getItem(STORAGE_KEY_FOLLOWUP);
          if (!raw) return;
          const data = parseJSONSafe(raw, null);
          if (!data) return;
          chkCall.checked = !!data.chkCall;
          chkEmail.checked = !!data.chkEmail;
          chkQuote.checked = !!data.chkQuote;
          chkBidding.checked = !!data.chkBidding;
          dateCall.value = data.dateCall || "";
          dateEmail.value = data.dateEmail || "";
          dateQuote.value = data.dateQuote || "";
          dateBidding.value = data.dateBidding || "";
          inputFollowupMemo.value = data.memo || "";
          refreshFollowupSummary();
          setStatusPill(followupStatus, "ok", "í›„ì† ì¡°ì¹˜ ìƒíƒœ: ì €ì¥ëœ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.");
        } catch (e) {
          // ignore
        }
      }

      function saveFollowup() {
        const data = {
          chkCall: chkCall.checked,
          chkEmail: chkEmail.checked,
          chkQuote: chkQuote.checked,
          chkBidding: chkBidding.checked,
          dateCall: dateCall.value || "",
          dateEmail: dateEmail.value || "",
          dateQuote: dateQuote.value || "",
          dateBidding: dateBidding.value || "",
          memo: inputFollowupMemo.value || "",
          updatedAt: new Date().toISOString()
        };
        try {
          localStorage.setItem(STORAGE_KEY_FOLLOWUP, JSON.stringify(data));
        } catch (e) {
          // ignore
        }
        refreshFollowupSummary();
        setStatusPill(followupStatus, "ok", "í›„ì† ì¡°ì¹˜ ìƒíƒœ: ì €ì¥ ì™„ë£Œ");
      }

      function clearFollowup() {
        chkCall.checked = false;
        chkEmail.checked = false;
        chkQuote.checked = false;
        chkBidding.checked = false;
        dateCall.value = "";
        dateEmail.value = "";
        dateQuote.value = "";
        dateBidding.value = "";
        inputFollowupMemo.value = "";
        followupSummary.innerHTML =
          "<strong>ë‹¤ìŒ í•  ì¼ ìš”ì•½:</strong> ì²´í¬ë¦¬ìŠ¤íŠ¸ë¥¼ ì„ íƒí•˜ë©´ ì—¬ê¸° í•œ ì¤„ë¡œ ì •ë¦¬ë©ë‹ˆë‹¤.";
        setStatusPill(followupStatus, "warn", "í›„ì† ì¡°ì¹˜ ìƒíƒœ: ì´ˆê¸°í™”ë¨ (ì €ì¥ í•„ìš”)");
        try {
          localStorage.removeItem(STORAGE_KEY_FOLLOWUP);
        } catch (e) {
          // ignore
        }
      }

      function refreshFollowupSummary() {
        const items = [];
        if (chkCall.checked) {
          items.push("ì „í™” ìƒë‹´ (" + (dateCall.value || "ì¼ì • ë¯¸ì •") + ")");
        }
        if (chkEmail.checked) {
          items.push("ì•ˆë‚´ ë©”ì¼/íšŒì‹  (" + (dateEmail.value || "ì¼ì • ë¯¸ì •") + ")");
        }
        if (chkQuote.checked) {
          items.push("ê²¬ì /ì¸ë³´ì´ìŠ¤ (" + (dateQuote.value || "ì¼ì • ë¯¸ì •") + ")");
        }
        if (chkBidding.checked) {
          items.push("ì…ì°°/ì¡°ë‹¬ (" + (dateBidding.value || "ì¼ì • ë¯¸ì •") + ")");
        }

        const memo = inputFollowupMemo.value.trim();
        if (!items.length && !memo) {
          followupSummary.innerHTML =
            "<strong>ë‹¤ìŒ í•  ì¼ ìš”ì•½:</strong> ì²´í¬ë¦¬ìŠ¤íŠ¸ë¥¼ ì„ íƒí•˜ë©´ ì—¬ê¸° í•œ ì¤„ë¡œ ì •ë¦¬ë©ë‹ˆë‹¤.";
          return;
        }

        const parts = [];
        if (items.length) {
          parts.push("<strong>ë‹¤ìŒ í•  ì¼:</strong> " + items.join(", "));
        }
        if (memo) {
          parts.push("<strong>ë©”ëª¨:</strong> " + memo.replace(/\n+/g, " / "));
        }
        followupSummary.innerHTML = parts.join("<br>");
      }

      function getCustomerSummary() {
        const name = inputName.value.trim();
        const title = inputTitle.value.trim();
        const org = inputOrg.value.trim();
        const dept = inputDept.value.trim();
        const field = inputField.value.trim();
        const budget = inputBudget.value.trim();
        const shortNote = inputShortNote.value.trim();

        const hasBasic = isValidNonEmpty(name) || isValidNonEmpty(org);
        if (!hasBasic) {
          basicError.classList.add("visible");
          setStatusPill(
            basicStatus,
            "error",
            "ê¸°ë³¸ ì •ë³´ ìƒíƒœ: ì´ë¦„ ë˜ëŠ” ê¸°ê´€ì´ ë¹„ì–´ ìˆì–´ ì•ˆë‚´ì„œ ìƒì„±ì´ ë¶ˆê°€í•©ë‹ˆë‹¤."
          );
          return null;
        }
        basicError.classList.remove("visible");
        setStatusPill(
          basicStatus,
          "ok",
          "ê¸°ë³¸ ì •ë³´ ìƒíƒœ: ì•ˆë‚´ì„œ ìƒì„±ì— í•„ìš”í•œ ìµœì†Œ ì •ë³´ê°€ ì…ë ¥ë˜ì—ˆìŠµë‹ˆë‹¤."
        );

        const lines = [];
        if (name || org) {
          let line = "";
          if (org) line += org;
          if (dept) line += (line ? " " : "") + dept;
          if (name) line += (line ? " " : "") + name + " " + (title || "ì„ ìƒë‹˜");
          lines.push(line);
        }
        if (field) {
          lines.push("ì—°êµ¬/ê´€ì‹¬ ë¶„ì•¼: " + field);
        }
        if (budget) {
          lines.push("ì˜ˆìƒ ì˜ˆì‚°/ì—°êµ¬ë¹„: " + budget);
        }
        if (shortNote) {
          lines.push("ë‚´ ë©”ëª¨: " + shortNote);
        }

        return {
          name: name,
          title: title,
          org: org,
          dept: dept,
          field: field,
          budget: budget,
          shortNote: shortNote,
          lines: lines
        };
      }

      function buildGuideText() {
        const customer = getCustomerSummary();
        if (!customer) return null;

        const guideType = selectGuideType.value;
        const tone = selectTone.value;
        const channel = selectChannel.value;
        const keywordsRaw = inputKeywords.value || "";
        const keywords = keywordsRaw
          .split(",")
          .map((k) => k.trim())
          .filter((k) => k.length > 0);
        const reportsText = inputReports.value || "";
        const reportLines = reportsText
          .split(/\r?\n/)
          .map((l) => l.trim())
          .filter((l) => l.length > 0);
        const memo = inputLongMemo.value.trim();

        const lines = [];

        // 1) ì¸ì‚¬ë§
        let greetingName = "";
        if (customer.org && customer.dept) {
          greetingName = customer.org + " " + customer.dept;
        } else if (customer.org) {
          greetingName = customer.org;
        }
        if (customer.name) {
          greetingName += (greetingName ? " " : "") + customer.name + " " + (customer.title || "ì„ ìƒë‹˜");
        }

        const baseGreeting =
          tone === "soft"
            ? "ì•ˆë…•í•˜ì„¸ìš”."
            : tone === "brief"
            ? "ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ."
            : "ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ.";

        if (greetingName) {
          lines.push(baseGreeting + " " + greetingName + "");
        } else {
          lines.push(baseGreeting + " ì›”ë“œì‚°ì—…ì •ë³´ì„¼í„° ë‹´ë‹¹ìì…ë‹ˆë‹¤.");
        }

        // 2) ìê¸°ì†Œê°œ + ìƒí™© ìš”ì•½
        const introLines = [];
        if (guideType === "new") {
          introLines.push(
            "ì›”ë“œì‚°ì—…ì •ë³´ì„¼í„°ì—ì„œ " +
              (customer.field || "ê´€ë ¨ ì‚°ì—…Â·ê¸°ìˆ ") +
              " ë¶„ì•¼ í•´ì™¸ ì‹œì¥Â·ê¸°ìˆ  ìë£Œë¥¼ ì•ˆë‚´ë“œë¦¬ê³  ìˆëŠ” ë‹´ë‹¹ìì…ë‹ˆë‹¤."
          );
          introLines.push(
            "ì—°êµ¬Â·ì‚¬ì—… ê¸°íšì— í™œìš©í•˜ì‹¤ ìˆ˜ ìˆëŠ” ìµœì‹  ì‹œì¥ë™í–¥, ì£¼ìš” ì—…ì²´Â·ê¸°ìˆ , íˆ¬ìÂ·ê·œëª¨ ë°ì´í„° ë“±ì„ ì •ë¦¬í•œ ìë£Œë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤."
          );
        } else if (guideType === "follow") {
          introLines.push(
            "ì´ì „ì— ì•ˆë‚´ë“œë ¸ë˜ ìë£Œì™€ " +
              (customer.field || "ì—°êµ¬") +
              " ê´€ë ¨ ì¶”ê°€ ë¬¸ì˜ ì£¼ì‹  ë‚´ìš©ì„ í•¨ê»˜ ë°˜ì˜í•˜ì—¬ ì •ë¦¬í•´ ë“œë¦½ë‹ˆë‹¤."
          );
          introLines.push(
            "ê¸°ì¡´ ê²€í†  ìë£Œì™€ ë¹„êµÂ·ë³´ì™„ì´ ê°€ëŠ¥í•˜ë„ë¡, ì—°ì†ì„ ìƒì—ì„œ í™œìš©í•˜ì‹¤ ìˆ˜ ìˆëŠ” ë³´ê³ ì„œë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ êµ¬ì„±í•˜ì˜€ìŠµë‹ˆë‹¤."
          );
        } else {
          introLines.push(
            "ì •ê¸°ì ìœ¼ë¡œ " +
              (customer.field || "ê´€ì‹¬ ë¶„ì•¼") +
              " ê´€ë ¨ í•´ì™¸ ì‹œì¥Â·ê¸°ìˆ  ë™í–¥ì„ ì •ë¦¬í•˜ì—¬ ì•ˆë‚´ë“œë¦¬ê³  ìˆìŠµë‹ˆë‹¤."
          );
          introLines.push(
            "ì´ë²ˆì—ëŠ” ìµœê·¼ 1~2ë…„ ì‚¬ì´ ì—…ë°ì´íŠ¸ëœ ë‚´ìš© ìœ„ì£¼ë¡œ, ê¸°ì¡´ ë³´ê³ ì„œì™€ ì—°ê³„í•˜ì—¬ í™œìš© ê°€ëŠ¥í•œ ìë£Œë“¤ì„ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤."
          );
        }

        if (keywords.length) {
          introLines.push("íŠ¹íˆ, " + keywords.join(", ") + " ë“±ì˜ í‚¤ì›Œë“œë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ í•œ ë‚´ìš©ì´ í¬í•¨ë©ë‹ˆë‹¤.");
        }

        if (customer.shortNote) {
          introLines.push("ë‚´ë¶€ ë©”ëª¨ìƒ ì°¸ê³  ì‚¬í•­: " + customer.shortNote + ".");
        }

        if (memo) {
          introLines.push("ê³ ê° ìš”ì²­/ìƒí™© ë©”ëª¨ ìš”ì•½: " + memo.replace(/\n+/g, " / "));
        }

        lines.push("");
        lines.push("[1] ê³ ê° ìƒí™© ë° ì•ˆë‚´ ëª©ì ");
        introLines.forEach((l) => lines.push("Â· " + l));

        // 3) ì œì•ˆ ë³´ê³ ì„œ / ìë£Œ ëª©ë¡
        lines.push("");
        lines.push("[2] ì œì•ˆ ë“œë¦¬ëŠ” ë³´ê³ ì„œ / ìë£Œ ëª©ë¡");

        if (reportLines.length) {
          reportLines.forEach((title, idx) => {
            const num = String(idx + 1).padStart(2, "0");
            lines.push(num + ") " + title);
          });
        } else {
          lines.push("í˜„ì¬ ê³ ê° DB ê¸°ì¤€ìœ¼ë¡œ ë“±ë¡ëœ ë³´ê³ ì„œ ëª©ë¡ì´ ì—†ì–´, ì¶”í›„ í™•ì •ë˜ëŠ” ìë£Œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‹¤ì‹œ ì •ë¦¬ë“œë¦½ë‹ˆë‹¤.");
        }

        lines.push(
          "â€» ê° ë³´ê³ ì„œëŠ” ëª©ì°¨Â·ìš”ì•½ë³¸ì„ ë³„ë„ íŒŒì¼(PDF) ë˜ëŠ” ì›Œë“œ ë¬¸ì„œë¡œ ì œê³µí•´ ë“œë¦´ ìˆ˜ ìˆìœ¼ë©°, í•„ìš” ì‹œ ì¼ë¶€ ì±•í„° ì¤‘ì‹¬ì˜ ì„ íƒ ê²€í† ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤."
        );

        // 4) í™œìš© ë°©ë²• / ì˜ˆì‚° ê´€ë ¨ ì•ˆë‚´
        lines.push("");
        lines.push("[3] í™œìš© ë°©ë²• ë° ì˜ˆì‚° ê´€ë ¨ ì•ˆë‚´");

        if (customer.budget) {
          lines.push(
            "Â· ì˜ˆìƒ ì˜ˆì‚°(" +
              customer.budget +
              ") ë²”ìœ„ ë‚´ì—ì„œ ìµœì ì˜ ì¡°í•©ì„ ì œì•ˆë“œë¦´ ìˆ˜ ìˆë„ë¡, ìš°ì„  ìˆœìœ„ê°€ ë†’ì€ ìë£Œë¶€í„° ê²€í† ë¥¼ ì§„í–‰í•˜ì‹œë©´ ì¢‹ìŠµë‹ˆë‹¤."
          );
        } else {
          lines.push(
            "Â· ì—°êµ¬ê³¼ì œ ë˜ëŠ” ë¶€ì„œ ì˜ˆì‚° ë²”ìœ„ì— ë§ì¶°, í•„ìˆ˜ ìë£Œì™€ ì„ íƒ ìë£Œë¥¼ êµ¬ë¶„í•˜ì—¬ ë‹¨ê³„ì ìœ¼ë¡œ êµ¬ë§¤Â·í™œìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
          );
        }

        lines.push(
          "Â· ì—°êµ¬ ë°©í–¥ ì„¤ì •, ì¤‘ì¥ê¸° ë¡œë“œë§µ ìˆ˜ë¦½, ì‹ ê·œ ì‚¬ì—… ê²€í† , ê²½ìŸì‚¬Â·í•´ì™¸ì—…ì²´ ë²¤ì¹˜ë§ˆí‚¹ ìë£Œë¡œ í•¨ê»˜ í™œìš© ê°€ëŠ¥í•©ë‹ˆë‹¤."
        );
        lines.push(
          "Â· í•„ìš” ì‹œ, ë™ì¼ ì£¼ì œì˜ ë‹¤ë¥¸ ë°œí–‰ì‚¬ ìë£Œ(ê²½ìŸÂ·ë³´ì™„ ê°€ëŠ¥í•œ íƒ€ ë³´ê³ ì„œ)ë„ ë¹„êµ ì•ˆë‚´í•´ ë“œë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
        );

        // 5) í›„ì† ì¡°ì¹˜ / ì‘ë‹µ ìš”ì²­
        lines.push("");
        lines.push("[4] í›„ì† ì§„í–‰ ë° í•„ìš” ì •ë³´ ì•ˆë‚´");

        if (channel === "email") {
          lines.push(
            "Â· ê²€í†  í›„ ê´€ì‹¬ ìˆìœ¼ì‹  ë³´ê³ ì„œ(ì œëª© ë˜ëŠ” ë²ˆí˜¸)ë¥¼ ë©”ì¼ íšŒì‹ ìœ¼ë¡œ ì•Œë ¤ì£¼ì‹œë©´, ëª©ì°¨ì™€ ê°€ê²©, ì œê³µ ë°©ì‹(ì„œì /PDF/ë°ì´í„° ë“±)ì„ ë‹¤ì‹œ ì •ë¦¬í•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤."
          );
        } else if (channel === "word") {
          lines.push(
            "Â· ì´ ì•ˆë‚´ì„œëŠ” ì›Œë“œ/í•œê¸€ ë¬¸ì„œ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±ë˜ì–´ ìˆìœ¼ë©°, ë‚´ë¶€ ê³µìœ ìš©ìœ¼ë¡œ í¸ì§‘Â·ì¶”ê°€ ê¸°ì… í›„ ì‚¬ìš©í•˜ì…”ë„ ë¬´ë°©í•©ë‹ˆë‹¤."
          );
          lines.push(
            "Â· ê²€í†  í›„ ë‚´ë¶€ì—ì„œ í™•ì •ëœ ë³´ê³ ì„œ ëª©ë¡ì„ ì •ë¦¬í•´ ì£¼ì‹œë©´, ë³„ë„ ë©”ì¼ì„ í†µí•´ ê²¬ì ì„œÂ·ì¸ë³´ì´ìŠ¤ ë° ë‚©í’ˆ ì¼ì •ì„ ì•ˆë‚´ë“œë¦¬ê² ìŠµë‹ˆë‹¤."
          );
        } else {
          lines.push(
            "Â· ë©”ì¼ ë³¸ë¬¸/ì›Œë“œ ë¬¸ì„œ ì–´ëŠ ìª½ìœ¼ë¡œ ì‚¬ìš©í•˜ì…”ë„ ë˜ë„ë¡, ì „ì²´ ë‚´ìš©ì„ í•œ ë²ˆì— ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤."
          );
          lines.push(
            "Â· ë‚´ë¶€ ê²€í†  í›„ íšŒì‹  ì£¼ì‹œë©´, ìµœì¢… í™•ì •ëœ ë³´ê³ ì„œ ëª©ë¡ ê¸°ì¤€ìœ¼ë¡œ ê²¬ì Â·ë‚©í’ˆ ë“± í›„ì† ì ˆì°¨ë¥¼ ë°”ë¡œ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤."
          );
        }

        lines.push(
          "Â· ì…ì°° ë˜ëŠ” ì¡°ë‹¬ ë“±ë¡ì´ í•„ìš”í•œ ê²½ìš°, ê¸°ê´€ë³„ ê·œì •ì— ë§ì¶”ì–´ ë“±ë¡ ê°€ëŠ¥ ì—¬ë¶€ ë° ì§„í–‰ ì ˆì°¨ë„ í•¨ê»˜ í™•ì¸í•´ ë“œë¦½ë‹ˆë‹¤."
        );

        // 6) ë§ˆë¬´ë¦¬ ì¸ì‚¬
        lines.push("");
        lines.push("[5] ë§ˆë¬´ë¦¬ ì¸ì‚¬");

        if (customer.org || customer.field) {
          lines.push(
            "ì–¸ê¸‰í•´ ì£¼ì‹  " +
              (customer.field || "ì—°êµ¬/ì‚¬ì—…") +
              " ë°©í–¥ì— ì‹¤ì œ ë„ì›€ì´ ë  ìˆ˜ ìˆë„ë¡, ìµœì‹  ìë£Œ ê¸°ì¤€ìœ¼ë¡œ ê³„ì† ë³´ì™„í•´ ë‚˜ê°€ê² ìŠµë‹ˆë‹¤."
          );
        } else {
          lines.push(
            "ì—°êµ¬ ë° ì‚¬ì—… ê³„íš ìˆ˜ë¦½ì— ì§ì ‘ ë„ì›€ì´ ë˜ì‹¤ ìˆ˜ ìˆë„ë¡, ìµœì‹  ìë£Œ ê¸°ì¤€ìœ¼ë¡œ ê³„ì† ë³´ì™„í•´ ë‚˜ê°€ê² ìŠµë‹ˆë‹¤."
          );
        }

        lines.push(
          "ì¶”ê°€ë¡œ í•„ìš”í•˜ì‹  ì£¼ì œë‚˜ ìë£Œê°€ ìˆìœ¼ì‹œë©´ ì–¸ì œë“ ì§€ í¸í•˜ê²Œ ë§ì”€í•´ ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤."
        );
        lines.push("");
        lines.push("ì›”ë“œì‚°ì—…ì •ë³´ì„¼í„° ë“œë¦¼");

        return lines.join("\n");
      }

      function renderGuideFromPlain(text) {
        if (!isValidNonEmpty(text)) {
          guidePreviewBox.innerHTML =
            '<div class="preview-empty">ì•„ì§ ìë™ ì•ˆë‚´ì„œê°€ ì—†ìŠµë‹ˆë‹¤. ì™¼ìª½ì—ì„œ ì •ë³´ë¥¼ ì…ë ¥í•œ ë’¤ ë‹¤ì‹œ ìƒì„±í•´ ì£¼ì„¸ìš”.</div>';
          guidePlainText.value = "";
          return;
        }

        const lines = text.split(/\r?\n/);
        const container = document.createElement("div");
        let currentSection = null;

        function addSection(title) {
          currentSection = document.createElement("div");
          const h = document.createElement("div");
          h.className = "guide-section-title";
          h.textContent = title;
          currentSection.appendChild(h);
          container.appendChild(currentSection);
        }

        lines.forEach((line) => {
          const trimmed = line.trim();
          if (!trimmed) {
            const br = document.createElement("div");
            br.className = "guide-section-body";
            br.innerHTML = "&nbsp;";
            container.appendChild(br);
            currentSection = null;
            return;
          }

          const sectionMatch = trimmed.match(/^\[(\d+)\]\s*(.+)$/);
          if (sectionMatch) {
            addSection(sectionMatch[1] + ". " + sectionMatch[2]);
            return;
          }

          const numMatch = trimmed.match(/^(\d{2})\)\s*(.+)$/);
          if (numMatch) {
            if (!currentSection) {
              currentSection = document.createElement("div");
              container.appendChild(currentSection);
            }
            const p = document.createElement("div");
            p.className = "guide-section-body";
            p.textContent = numMatch[1] + ") " + numMatch[2];
            currentSection.appendChild(p);
            return;
          }

          if (!currentSection) {
            currentSection = document.createElement("div");
            container.appendChild(currentSection);
          }
          const p = document.createElement("div");
          p.className = "guide-section-body";
          p.textContent = trimmed;
          currentSection.appendChild(p);
        });

        guidePreviewBox.innerHTML = "";
        guidePreviewBox.appendChild(container);
      }

      function generateGuide() {
        const guideText = buildGuideText();
        if (!guideText) return;

        guidePlainText.value = guideText;
        renderGuideFromPlain(guideText);
        saveState();
        updateStatsOnGenerate();

        setStatusPill(guideStatus, "ok", "ì•ˆë‚´ì„œ ìƒíƒœ: ìë™ ìƒì„± ì™„ë£Œ");
        guideMetaText.textContent =
          "ìë™ ìƒì„±ëœ ì•ˆë‚´ì„œëŠ” ì´ ë¸Œë¼ìš°ì € localStorageì— ì €ì¥ë˜ë©°, ìƒˆë¡œê³ ì¹¨ í›„ì—ë„ ìœ ì§€ë©ë‹ˆë‹¤.";
      }

      function appendMemoToGuide() {
        const memo = inputLongMemo.value.trim();
        if (!memo) {
          setStatusPill(
            guideStatus,
            "warn",
            "ì•ˆë‚´ì„œ ìƒíƒœ: ì¶”ê°€í•  ë©”ëª¨ê°€ ì—†ìŠµë‹ˆë‹¤. ë©”ëª¨ë¥¼ ì…ë ¥í•œ ë’¤ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”."
          );
          return;
        }
        let current = guidePlainText.value || "";
        const addition = "\n\n[ì¶”ê°€ ë©”ëª¨]\n" + memo.replace(/\n+/g, "\nÂ· ");
        const updated = (current ? current + addition : addition).trim();
        guidePlainText.value = updated;
        renderGuideFromPlain(updated);
        saveState();
        setStatusPill(guideStatus, "ok", "ì•ˆë‚´ì„œ ìƒíƒœ: ë©”ëª¨ë¥¼ ë³¸ë¬¸ì— ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.");
      }

      function resetInputs() {
        inputName.value = "";
        inputTitle.value = "";
        inputOrg.value = "";
        inputDept.value = "";
        inputField.value = "";
        inputBudget.value = "";
        inputEmail.value = "";
        inputShortNote.value = "";
        inputKeywords.value = "";
        inputReports.value = "";
        inputLongMemo.value = "";
        basicError.classList.remove("visible");
        setStatusPill(basicStatus, "neutral", "ê¸°ë³¸ ì •ë³´ ìƒíƒœ: ëŒ€ê¸° ì¤‘");
        setStatusPill(optionStatus, "neutral", "ì˜µì…˜ ìƒíƒœ: ê¸°ë³¸ê°’ ì‚¬ìš© ì¤‘");
        saveState();
      }

      function copyGuideToClipboard() {
        const text = guidePlainText.value || "";
        if (!text.trim()) {
          setStatusPill(guideStatus, "warn", "ì•ˆë‚´ì„œ ìƒíƒœ: ë³µì‚¬í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.");
          return;
        }
        if (navigator.clipboard && navigator.clipboard.writeText) {
          navigator.clipboard
            .writeText(text)
            .then(function () {
              setStatusPill(guideStatus, "ok", "ì•ˆë‚´ì„œ ìƒíƒœ: í´ë¦½ë³´ë“œ ë³µì‚¬ ì™„ë£Œ");
            })
            .catch(function () {
              fallbackCopy(text);
            });
        } else {
          fallbackCopy(text);
        }
      }

      function fallbackCopy(text) {
        const temp = document.createElement("textarea");
        temp.style.position = "fixed";
        temp.style.opacity = "0";
        temp.value = text;
        document.body.appendChild(temp);
        temp.select();
        try {
          document.execCommand("copy");
          setStatusPill(guideStatus, "ok", "ì•ˆë‚´ì„œ ìƒíƒœ: í´ë¦½ë³´ë“œ ë³µì‚¬ ì™„ë£Œ");
        } catch (e) {
          setStatusPill(guideStatus, "error", "ì•ˆë‚´ì„œ ìƒíƒœ: ë³µì‚¬ ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        }
        document.body.removeChild(temp);
      }

      function insertWordMarkers() {
        const text = guidePlainText.value || "";
        if (!text.trim()) {
          setStatusPill(
            guideStatus,
            "warn",
            "ì•ˆë‚´ì„œ ìƒíƒœ: ì›Œë“œ êµ¬ë¶„ì„ ì„ ì¶”ê°€í•  ì•ˆë‚´ì„œê°€ ì—†ìŠµë‹ˆë‹¤."
          );
          return;
        }
        const markerLine = "\n------------------------------------------------------------\n";
        const enhanced = text + markerLine + "â€» ìœ„ ì•ˆë‚´ì„œëŠ” ì›Œë“œ/í•œê¸€ ë¬¸ì„œì— ë¶™ì—¬ ë„£ì–´ ë‚´Â·ì™¸ë¶€ ê³µìœ ìš©ìœ¼ë¡œ í™œìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.";
        guidePlainText.value = enhanced;
        renderGuideFromPlain(enhanced);
        saveState();
        setStatusPill(guideStatus, "ok", "ì•ˆë‚´ì„œ ìƒíƒœ: ì›Œë“œ êµ¬ë¶„ì„ ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.");
      }

      function switchToFormattedView() {
        toggleViewFormatted.classList.add("active");
        toggleViewPlain.classList.remove("active");
        guidePreviewBox.style.display = "block";
        guidePlainText.classList.remove("active");
      }

      function switchToPlainView() {
        toggleViewPlain.classList.add("active");
        toggleViewFormatted.classList.remove("active");
        guidePreviewBox.style.display = "none";
        guidePlainText.classList.add("active");
      }

      function onAnyInputChange() {
        saveState();
      }

      function init() {
        loadState();
        loadAndApplyStats();
        loadFollowup();
        setStatusPill(basicStatus, "neutral", "ê¸°ë³¸ ì •ë³´ ìƒíƒœ: ëŒ€ê¸° ì¤‘");
        setStatusPill(optionStatus, "neutral", "ì˜µì…˜ ìƒíƒœ: ê¸°ë³¸ê°’ ì‚¬ìš© ì¤‘");
      }

      btnGenerateGuide.addEventListener("click", function () {
        generateGuide();
      });

      btnAppendMemo.addEventListener("click", function () {
        appendMemoToGuide();
      });

      btnResetInputs.addEventListener("click", function () {
        resetInputs();
      });

      btnCopyGuide.addEventListener("click", function () {
        copyGuideToClipboard();
      });

      btnInsertWordMarkers.addEventListener("click", function () {
        insertWordMarkers();
      });

      toggleViewFormatted.addEventListener("click", function () {
        switchToFormattedView();
      });

      toggleViewPlain.addEventListener("click", function () {
        switchToPlainView();
      });

      [
        inputName,
        inputTitle,
        inputOrg,
        inputDept,
        inputField,
        inputBudget,
        inputEmail,
        inputShortNote,
        inputKeywords,
        inputReports,
        inputLongMemo,
        selectGuideType,
        selectTone,
        selectChannel
      ].forEach(function (el) {
        el.addEventListener("input", onAnyInputChange);
        el.addEventListener("change", onAnyInputChange);
      });

      btnSaveFollowup.addEventListener("click", function () {
        saveFollowup();
      });

      btnRefreshFollowup.addEventListener("click", function () {
        refreshFollowupSummary();
      });

      btnClearFollowup.addEventListener("click", function () {
        clearFollowup();
      });

      [chkCall, chkEmail, chkQuote, chkBidding, dateCall, dateEmail, dateQuote, dateBidding, inputFollowupMemo].forEach(
        function (el) {
          el.addEventListener("change", function () {
            refreshFollowupSummary();
          });
        }
      );

      document.addEventListener("DOMContentLoaded", function () {
        init();
      });
    })();
  </script>
</body>
</html>
